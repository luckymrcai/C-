# C++视频点播器服务器
## 项目描述
- 视频点播器是实现了一款基于RTSP流媒体视频点播的播放器功能。该项目由视频点播客户端、视频点播服务器、大并发压力测试程序三大部分构成，项目综合了《linux高级应用开发技术》和《linux基础开发》的知识体系；
- 采用大并发通信框架思想和自定义协议，基于TCP Socket封装了包含通信组件、动态数组以及线程池等技术的通信框架。以及基于RTSP的流媒体播放，基于FFMpeg的媒体数据的编解码功能。
- 服务端主要进行复杂视频列表数据的并发处理。
- 客户端从服务端获取视频列表，调用了FFMpeg进行解码进行播放。视频数据从Live555服务器获取。
## 开发环境
- CentOS 7.0、sqlite3、C++
## 技术要点
- socket、epoll、多进程、多线程、线程池、信号量、互斥锁、条件变量、高并发
## 服务器功能
### 接入功能
- 响应个客户端的接入请求
- 完成登录验证功能
- 管理和登记各客户端的信息
- 如果2分钟内未登陆，则关闭连接，清楚客户端信息
### 业务功能
- 用户登陆
- 响应客户端请求视频列表
- 响应客户端请求用户信息、用户视频播放记录
- 记录用户播放视频信息、播放时长的位置
- 心跳实现
### 实时日志
实现启动该日志进程后能够查看当前连接情况等信息，关闭该进程后不影响后台业务正常处理。实时刷新日志信息如下：
- 有效连接数
- 接收数据包
- 发送数据包
- 用户登录业务数
- 获取视频列表业务数
- 获取用户视频点播记录业务数
- 上传视频点播记录业务数
- 上传视频点播时长记录业务数
### 全部日志
实现日志信息写入文件。包括启动日志，登陆日志数据包，交易数据包，接收数据包，心态数据包，相关日志信息写入文本日志。文件每天生成一个。
时间：yyyy-mm-dd hh:mm:ss
功能：登陆
类型：发送/接收
用户id：xxxxxx
发送数据包（十六进制信息）：（16个字节一行）
01 92 92 13 21 31 23 32 12 32 32 33 32 52 32 52
01 92 92 13 21 31 23 32 12 32 32 33 32 52 32 52
01 92 92 13 21 31 23 32 12 32 32 33 32 52 32 52

时间：yyyy-mm-dd hh:mm:ss
功能：上传播放记录
类型：发送/接收
用户id：xxxxxx
01 92 92 13 21 31 23 32 12 32 32 33 32 52 32 52
01 92 92 13 21 31 23 32 12 32 32 33 32 52 32 52
01 92 92 13 21 31 23 32 12 32 32 33 32 52 32 52

## 使用方法
- yum install sqlite-devel #安装sqlite环境
- make
